{"componentChunkName":"component---src-templates-post-jsx","path":"/phase4/","result":{"data":{"site":{"siteMetadata":{"title":"hyungkishin.blog"}},"markdownRemark":{"id":"720fdeea-fb60-5df7-a27a-47eba40a7300","excerpt":"들어가며 1부에서 JS 번들 다이어트를 통해 전체 페이지의 무게를 줄이는 작업을 진행했다 🤔그러나 홈페이지의 성능은 거의 그대로였다.  google Lighthouse 에서 측정 해보면, \"왜 느려 보이는지\", \"어디서 막히는지\", \"어떻게 개선해야 하는지\"를 구체적으로 살펴 볼 수 있다. (겁나 친절한데 ..? 👍) 그 중에서도 Google이 공식적으로…","html":"<h2>들어가며</h2>\n<p>1부에서 JS 번들 다이어트를 통해 전체 페이지의 무게를 줄이는 작업을 진행했다<br>\n🤔그러나 홈페이지의 성능은 거의 그대로였다.</p>\n<p><img src=\"/static/test-64bff304b1cc203997cd8af6f40fd13a.gif\" alt=\"\"></p>\n<p>google Lighthouse 에서 측정 해보면, \"왜 느려 보이는지\", \"어디서 막히는지\", \"어떻게 개선해야 하는지\"를 구체적으로 살펴 볼 수 있다.<br>\n(겁나 친절한데 ..? 👍)</p>\n<p>그 중에서도 <strong>Google이 공식적으로 중요하게 여기는 핵심 성능 지표</strong>가 바로 <strong>Core Web Vitals</strong>다.</p>\n<h2>Core Web Vitals ⚡</h2>\n<table>\n<thead>\n<tr>\n<th>지표명 (약어)</th>\n<th>설명</th>\n<th>일상 비유</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>CLS</strong> (Cumulative Layout Shift)</td>\n<td>화면이 로딩 중 갑자기 밀리거나 이동한 정도</td>\n<td>버튼을 누르려는데 갑자기 밑으로 밀려서 광고 클릭한 상황</td>\n</tr>\n<tr>\n<td><strong>SI</strong> (Speed Index)</td>\n<td>화면이 시각적으로 완성되는 속도</td>\n<td>영화 시작할 때 화면이 빠르게 차오르는 느낌</td>\n</tr>\n<tr>\n<td><strong>FCP</strong> (First Contentful Paint)</td>\n<td>첫 텍스트나 이미지가 뜨는 시점</td>\n<td>영화 타이틀이 처음 뜨는 순간</td>\n</tr>\n<tr>\n<td><strong>LCP</strong> (Largest Contentful Paint)</td>\n<td>메인 이미지나 큰 텍스트가 완전히 보일 때</td>\n<td>표지부터 다 읽고 본문 읽을 준비 완료</td>\n</tr>\n<tr>\n<td><strong>TBT</strong> (Total Blocking Time)</td>\n<td>JS가 렌더링을 막은 총 시간</td>\n<td>문 열고 들어가려는데 안에서 JS 처리 중이라 안 열리는 상황</td>\n</tr>\n</tbody>\n</table>\n<h2>개선 목표</h2>\n<p><strong>CLS (Cumulative Layout Shift)</strong><br>\n<strong>FCP (First Contentful Paint)</strong><br>\n<strong>TBT (Total Blocking Time)</strong></p>\n<h2>CLS - Cumulative Layout Shift</h2>\n<p>👀 CLS 의 <strong>핵심</strong> 은 <strong>“보이는 걸 미리 예고하고, 갑자기 바꾸지 않는다”</strong> 이다.</p>\n<p>보통 화면이 예고 없이 ‘밀리는’ 현상이 원인인데, 페이지 로딩 중 요소들이 갑자기 이동하면, 사용자가 의도치 않은 클릭을 하거나 읽기 어려워진다.</p>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 1rem;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; '>\n      <a class='gatsby-resp-image-link' href='/static/11ed8baf466a3e7a9a5dcfde929f6679/a2372/img_5.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 58.82352941176471%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAAC1UlEQVR42m1SS0hUURgecJe7wBAFZ+5zXtU87p33OOOjEnQWjSNiQm3cSLkqIiPUMIbKZtKyVCwfDWE102RNunDhykWE0KTmI4xWkrjQ2Ywgo/B17vHVogsf93Du5fu/x68Kh8OYnJzEyMgIhoeHEY/HMTQ0hAtVVbDLEgwiD1GrhSAIYFkWPMeB4RmwBIzAgWVYcOROrVajsLAQqunpaSjP7u4u9vb26DmTySAYDEKWZWg0GnCEyGgwwEBwmuXg9XngLnWBETnyjaPDFFKGYaCKxWJIp9OYmZnB7OwslpeXKWprQ5Akif4kiiJMJhMsFgsl77zbgfaOdghaA86azXQQzwt0uGpiYgI7OzvY3NxENpulCjc2No4UKoQ8z0NLbGt1OhQVFyMajaL7cRRqjRo6cqfX6+lQSjg1NUVJcrncfy0fEnq8TrjcLkiyAz09UTyKPIDd7oTPXw5vqR9Go5HmqEqlUtjKbGF9fR3Z7W2SZY4qPLSsFMGSnFxuO+wOG1hOwKfUOBLJtyQ7LYlBonEoDqjCz4Twz9oaVldWMJf+hqWFBSzOzyMUOiZkSJMejxNmqxkFBafwYrCfbMVL2qqiXoFSDCVMJuL4/vULPr5P4F5LE/o67+BN7BUllA8IS0rUuHK5AYFANSS7C623b6K17RYcDiecLg8cTjf0pBhqOZlIYHXpB/p7e2HkRJz3VWBsdBT19fX/KGRwtbkJwboQjCYJPYPP0TXQCyvJ0+UphZvAYDjIMBF/h98/V3CtuQV5eSeQn38S3V0RNDZegtVqJTYYmk9ldQ3cgYvQecrwpO8pwTMYvWVw+StRXnHuWOEHYvnX4hzablyHpqgIFp0WCWK54dI+IW2Z5GP1+iCTNi1uL4KhOgorsSuTpm12B10fmmHk4X0kx2J4TYKOhDsxQFZinAypCQRgs9moZUWl3+8mbZ6h+yaSAcpbIGXsbwF7VMpfegb4jP7N49EAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='뭐야..이거' title='' src='/static/11ed8baf466a3e7a9a5dcfde929f6679/ca1dc/img_5.png' srcset='/static/11ed8baf466a3e7a9a5dcfde929f6679/e7570/img_5.png 170w,\n/static/11ed8baf466a3e7a9a5dcfde929f6679/f46e7/img_5.png 340w,\n/static/11ed8baf466a3e7a9a5dcfde929f6679/ca1dc/img_5.png 680w,\n/static/11ed8baf466a3e7a9a5dcfde929f6679/02d09/img_5.png 1020w,\n/static/11ed8baf466a3e7a9a5dcfde929f6679/9d567/img_5.png 1360w,\n/static/11ed8baf466a3e7a9a5dcfde929f6679/a2372/img_5.png 1621w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>뭐야..이거</figcaption>\n  </figure></p>\n<p>그런데, 나의 경우는 달랐다. 사용자가 보기엔 그냥 지나가는 광고였지만,<br>\nLighthouse 기준으로는 CLS가 다섯 번이나 터졌다.<br>\n\"응? 나 아무것도 안 건드렸는데요…?\" 싶을 정도.</p>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 1rem;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 412px; '>\n      <a class='gatsby-resp-image-link' href='/static/fbb2920be03788f99e0b3c9c3b227923/1f9f1/img_4.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 52.352941176470594%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAAClklEQVR42hWQ208aeRiGuWs2MTGtdauNG0tJbVdhK6Kog6dxZsBhZoA5wcxyEkRcRESrLWh3m6xNSJN2D9mr/W+f/e3Fm/fu+d7viRj6PvenUcadKL1mjIK2xMriM2Lz0zyZ/o7MjwucGxsMjDTX5ibvChIjX+GdK1NMx4h+/4hGJcn4JuTzrz8TKVgqF2WZ81KCwNnGzGaIL84SnXvM85kpnO03dHIpqnKS87zEQ83iS9vlr7OASTOPsREl/moGTX7L+ahPxLF1atUKup5Dtwrk1AN+mJ3i2ZMppDcL9PQ0bW2dk2ya+kGSSwH9zdcYFva49VVufJm5x1PMz0zjdwXQdfIc13z+X1pwLHRZIr4wwwuxsKmkGJg7hLsJsqklKpllztQ1usoqgfSaa0fmLswJRbPEFuc5vhoT8TyTTisUQA2zZFF3DKo7CVKvnnNlHzIs7nOaS9NS1xmaEl9bJSYtiyNxINxPMvIOSb6cY0uW6T/8ScQXwG67imPnKNgWjbJDbWsZO5PgqqQwcrN8KueYVPPcl2T+7vj8O6hxJ9794KnCZxFl8yfKF7dcTv4RQN/ipFnBLCoYtoHvu7TkFD1jl4t8hkF+hw8CPNC2OdlN8hDkeajkRB/xR9vjS83AzGc5+/2bWPiNiCVevR32GNdO6DgBoeWhrC7RM3dpK+sc769RkxKEW3HKItbbGOHmCn0tzY25R0fbxG+d0rmfcHz7iciRfkgj8Bh7VQZ2ne5RGXV1mfphmlHd5q5hMXBVXGkVK/ma6t4a17ZG8yBFTbgOdJng4j1B/z2h6Iiq7GHqCr+c2Zy6HgO1xE3Oonug8NFtMTSEu2pIKbNGcv4p0osFihsrNOQNPClO0fOwO5eUWj2RPv8B0z97u9ajFJoAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='출처 - 5분 순삭' title='' src='/static/fbb2920be03788f99e0b3c9c3b227923/1f9f1/img_4.png' srcset='/static/fbb2920be03788f99e0b3c9c3b227923/e7570/img_4.png 170w,\n/static/fbb2920be03788f99e0b3c9c3b227923/f46e7/img_4.png 340w,\n/static/fbb2920be03788f99e0b3c9c3b227923/1f9f1/img_4.png 412w' sizes='(max-width: 412px) 100vw, 412px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>출처 - 5분 순삭</figcaption>\n  </figure></p>\n<p>대표적으로 <strong>Taboola 광고 위젯</strong> , 이미지 영역, 비동기 컴포넌트, 웹폰트 로딩 지연 등이 주요 원인 이였다.</p>\n<p>Taboola 는 초기엔 비어 있다가 스크립트 로딩 이후에 콘텐츠가 삽입되는데,<br>\n이때 높이를 미리 잡아두지 않으면 아래 콘텐츠들이 순식간에 밀려나며 CLS가 발생한다.</p>\n<blockquote>\n<p>마치 의자에 앉으려고 했는데, 뒤로 밀려서 엉덩방아 찍은 느낌이다.</p>\n</blockquote>\n<table>\n<thead>\n<tr>\n<th>문제 요소</th>\n<th>설명</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>이미지/광고 영역의 크기 미지정</td>\n<td><code class=\"language-text\">&lt;img></code>나 광고 <code class=\"language-text\">&lt;div></code>에 <code class=\"language-text\">width</code>, <code class=\"language-text\">height</code>, 또는 <code class=\"language-text\">aspect-ratio</code>가 없어 로딩 후 밀림 발생</td>\n</tr>\n<tr>\n<td>비동기 렌더링 컴포넌트</td>\n<td><code class=\"language-text\">dynamic(import(...))</code>, <code class=\"language-text\">&lt;Suspense></code> 등을 통해 불쑥 나타나는 컴포넌트로 인해 레이아웃 밀림 발생</td>\n</tr>\n<tr>\n<td>navigation 메뉴/헤더 애니메이션</td>\n<td>fixed 헤더가 transition으로 등장하면서 콘텐츠를 아래로 밀어냄</td>\n</tr>\n<tr>\n<td>웹폰트 로딩 지연</td>\n<td>FOIT/FOUT 현상으로 텍스트 표시가 밀려 CLS 유발</td>\n</tr>\n<tr>\n<td>광고/소셜 위젯 로딩 지연</td>\n<td>GPT 광고, Interplay, Taboola 등 외부 위젯이 나중에 등장하면서 전체 구조가 밀림</td>\n</tr>\n</tbody>\n</table>\n<p>이런 문제를 해결하는 가장 확실한 방법은, 비동기 렌더링 컴포넌트의 <strong>높이를 미리 지정</strong>해 콘텐츠의 위치를 <strong>예고</strong>하는 것이다.</p>\n<p>하지만 비동기 렌더링 컴포넌트는 렌더 시점까지 공간을 차지하지 않기 때문에, 아래 콘텐츠가 갑자기 밀려버리는 수가 있다.</p>\n<p>이런 경우에 react 에서 제공하는 <code class=\"language-text\">&lt;Suspense></code> 태그를 사용하면, 다음과 같은 효과를 볼 수 있다.</p>\n<p>\"아. 이 컴포넌트가 아직 준비 안 됐을 수도 있으니, 그동안 대체 UI (fallback) 를 보여 줘야겠구만?\"</p>\n<p>ex ) 코드 레벨 예시</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> dynamic <span class=\"token keyword\">from</span> <span class=\"token string\">\"next/dynamic\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Skeleton <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@/components/Skeleton\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// dynamic 컴포넌트 로딩 시 Skeleton 사용</span>\n<span class=\"token keyword\">const</span> RelatedStories <span class=\"token operator\">=</span> <span class=\"token function\">dynamic</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"./RelatedStories\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">ssr</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function-variable function\">loading</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token operator\">&lt;</span>Skeleton <span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Suspense 사용 시, fallback에 고정 높이 지정</span>\n<span class=\"token operator\">&lt;</span>Suspense fallback<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token operator\">&lt;</span>div style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">minHeight</span><span class=\"token operator\">:</span> <span class=\"token number\">400</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>Skeleton <span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>RelatedStories articleId<span class=\"token operator\">=</span><span class=\"token string\">\"abc123\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Suspense<span class=\"token operator\">></span></code></pre></div>\n<blockquote>\n<p>⚠️ 주의<br>\n<Skeleton /> 컴포넌트 자체가 min-height 또는 fixed height를 갖지 않는다면 의미가 없다.<br>\nfallback 은 시각적 장식이 아니라 레이아웃 안정장치라는 점을 명심해야 한다.</p>\n</blockquote>\n<hr>\n<p>그런데, CLS를 해결하려고 구조를 정리하다 보니, 자연스럽게 컴포넌트들이 렌더링 되는 시점에 의문을 갖기 시작했다.</p>\n<p>광고 컴포넌트 는 기사 본문 을 다 읽고 나서, <strong>본문 하단에 보이는 영역</strong> 이다.<br>\n애초에 사용자가 그렇게 빨리 글을 읽나 ..?</p>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 1rem;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 482px; '>\n      <a class='gatsby-resp-image-link' href='/static/a2d0a5986c250918b56560f4f535e5c0/b58a3/img_3.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 52.94117647058824%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAADIklEQVR42h2RW0+bBQCGPy4kQdhYMkHQBElAZS5AwkEJGIGJYxGQASXQJkKhrGWU1dHCgLaUhg4GFpTDxoqMceiY8NGuXbEUSpGtZI6D3dQbrzQh2f94/OLte/HkfZ9XkNdcwtjXRb/ZxJ07ZqxTQ9jn7LR2aZEr5bRpFChkBWR8kkJC8jukXkhDpdFhsQ2j1ragbLtKo7IWjV6NxdqOMGvt5N6IhZWlB7h8q4iig8feJSpauympUqNUy/msKBshKorYuBjejo0m69Ms2rv1yK81M7N6F6Ndyw19C8OWVoTiojwqFG34w1u4w9tsPA/ieRFi6mcnl6oaUKhVXMzN463oKKJjoklKOkdu/sdcNyjpMLSh0jWjNWnpHehhwqZCSHovni/KShHDO3h++xVf5AjPyTGBP0+YcM6TVaamtFrOl4Xp5GenUlWeQ1d9AYOmW9wcmqCnowmtvpUWnZLJQQVC2sUPycjJ5uv6Gtb3/HiODtn8+1+G52cln2NSexXFlXXUymrobPicvuYShjobaVB1k3IhT/LXRp99lG6LBoe5FiEnM53aslyaGipZ9IksBDeZ3/LSd9soTWrnh4VpiitqJW+VKJpbaKos5nJVPfGJycTFnyGz8DLf6gyYzO08MFYj3FB8hamjjn79NRbd0inhZ7w8fYPvVYT1g13syy7G709i65BRWl5O2keZnE9MJPZsHIVXZJjvh9CPr9H7nYyH1kYE44ABu2OcBfcjxB0P3oM9wv+csikB10JbOMR1lpYd2Ed7ySvKJyEljeSUDyRNBRhnNhj8KcDw47+YHulh2qpEeOR1Im6LbARduIJPeBoO8svxS/y/H7MdOST0+oWUbePaWqaq7grvJr/PmfMJJKWm03prBIvDj+XhIXcXPdiHbyJs7rlZC2zg2vfh2n2C93mArdev2I0c8OzEj2/fhdu/zNLqDCadglHNN5TkZhBzNl6afY7qFgPmuV2+X49gG7MhiEG3BPLg3t/EGw7832ZHAv7x5hRfyMma+CMrKxOIrjkcs7eZNKmYNF6n/94OmoFZlD12eqeeYl06YmzOyX9iQRC30ynMYAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='읽을 시간좀 ...' title='' src='/static/a2d0a5986c250918b56560f4f535e5c0/b58a3/img_3.png' srcset='/static/a2d0a5986c250918b56560f4f535e5c0/e7570/img_3.png 170w,\n/static/a2d0a5986c250918b56560f4f535e5c0/f46e7/img_3.png 340w,\n/static/a2d0a5986c250918b56560f4f535e5c0/b58a3/img_3.png 482w' sizes='(max-width: 482px) 100vw, 482px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>읽을 시간좀 ...</figcaption>\n  </figure></p>\n<blockquote>\n<p>‼️ <strong>“보이지 않는 요소는 애초에 늦게 보여줘도 된다.”</strong></p>\n</blockquote>\n<p>즉, 굳이 초반에 렌더링할 필요 없는 컴포넌트는 <strong>Lazy Load</strong>로 뒤로 미루고,<br>\n대신 <strong>초기 화면을 안정적으로 고정</strong>해두는 것이 사용자 경험에도, 성능 측면에서도 훨씬 낫다.</p>\n<p>이게 바로 <strong>FCP 개선</strong>과도 밀접하게 연결되는 <strong>Lazy Load</strong> 이다.</p>\n<h2>Lazy Load ⏰</h2>\n<p>Taboola 광고는 스크롤이 일정 수준 내려간 후에야 자체 CDN 스크립트 (Taboola CDN) 를 호출해 UI를 동적으로 구성한다</p>\n<p><strong>초기 화면에서 반드시 필요하지 않은 요소</strong>라면, 애초에 <strong>Lazy Load</strong>로 처리하는 것이 맞다.<br>\n<strong>일정 스크롤 이후에만 렌더링되도록</strong> 하는 것이 합리적 이라고 판단했다.</p>\n<p>뉴스 기사 하단의 댓글 영역, 추천 콘텐츠, Taboola 광고 등은,<br>\n<strong>처음부터 보여줄 필요가 없는 전형적인 Lazy Load 대상</strong>이다.</p>\n<p>이를 위해 아래와 같은 <code class=\"language-text\">LazyShow</code> 유틸 컴포넌트를 사용했다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token string\">\"use client\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> useEffect<span class=\"token punctuation\">,</span> useRef<span class=\"token punctuation\">,</span> useState <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\">LazyShowProps</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">children</span><span class=\"token operator\">:</span> React<span class=\"token punctuation\">.</span>ReactNode<span class=\"token punctuation\">;</span>          <span class=\"token comment\">// Lazy 로딩할 자식 컴포넌트</span>\n  rootMargin<span class=\"token operator\">?</span><span class=\"token operator\">:</span> string<span class=\"token punctuation\">;</span>                <span class=\"token comment\">// IntersectionObserver의 rootMargin 설정 (기본값: 200px)</span>\n  threshold<span class=\"token operator\">?</span><span class=\"token operator\">:</span> number<span class=\"token punctuation\">;</span>                 <span class=\"token comment\">// 교차 비율 임계값 (기본값: 0.1 = 10% 보이면 발동)</span>\n  once<span class=\"token operator\">?</span><span class=\"token operator\">:</span> boolean<span class=\"token punctuation\">;</span>                     <span class=\"token comment\">// true일 경우 한 번만 보여주고 계속 유지, false면 스크롤에 따라 반복 토글</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/**\n * LazyShow\n * - 컴포넌트가 뷰포트에 들어왔을 때 children을 렌더링\n * - IntersectionObserver를 사용한 Lazy Load 유틸\n *  \n * @param children\n * @param rootMargin\n * @param threshold\n * @param once\n * @returns {JSX.Element}\n */</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> LazyShow <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> children<span class=\"token punctuation\">,</span> rootMargin <span class=\"token operator\">=</span> <span class=\"token string\">\"200px\"</span><span class=\"token punctuation\">,</span> threshold <span class=\"token operator\">=</span> <span class=\"token number\">0.1</span><span class=\"token punctuation\">,</span> once <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token operator\">:</span> LazyShowProps<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> ref <span class=\"token operator\">=</span> useRef<span class=\"token operator\">&lt;</span>HTMLDivElement<span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>isVisible<span class=\"token punctuation\">,</span> setIsVisible<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>ref<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n    \n    <span class=\"token comment\">// IntersectionObserver API를 지원하지 않는 환경(fallback 처리)</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"IntersectionObserver\"</span> <span class=\"token keyword\">in</span> window<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">setIsVisible</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// IntersectionObserver 인스턴스 생성</span>\n    <span class=\"token keyword\">const</span> observer <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">IntersectionObserver</span><span class=\"token punctuation\">(</span>\n        <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">[</span>entry<span class=\"token punctuation\">]</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>entry<span class=\"token punctuation\">.</span>isIntersecting<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n              <span class=\"token comment\">// 요소가 뷰포트에 들어오면 표시</span>\n              <span class=\"token function\">setIsVisible</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n              <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>once<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                  observer<span class=\"token punctuation\">.</span><span class=\"token function\">disconnect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 한 번만 보여줄 경우 감시 중단</span>\n              <span class=\"token punctuation\">}</span>\n          <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>once<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n              <span class=\"token comment\">// 반복 모드일 경우 다시 안 보이면 숨김 처리</span>\n              <span class=\"token function\">setIsVisible</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">{</span> rootMargin<span class=\"token punctuation\">,</span> threshold <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// 감시 시작</span>\n    observer<span class=\"token punctuation\">.</span><span class=\"token function\">observe</span><span class=\"token punctuation\">(</span>ref<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// 컴포넌트 언마운트 시 Observer 해제</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> observer<span class=\"token punctuation\">.</span><span class=\"token function\">disconnect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>rootMargin<span class=\"token punctuation\">,</span> threshold<span class=\"token punctuation\">,</span> once<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>div ref<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>ref<span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span>isVisible <span class=\"token operator\">?</span> children <span class=\"token operator\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 보일 때만 children 렌더링</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>CLS 방지를 위한 핵심 전략은 <strong>언제, 어디서, 무엇이 렌더링될지</strong>를 브라우저에게 <strong>미리 예고</strong>해주는 것이다.<br>\n그렇게 해야 사용자는 불쑥 튀어나오는 콘텐츠에 방해받지 않고, 안정적인 화면을 경험할 수 있다.</p>\n<p>하지만 모든 콘텐츠를 미리 자리를 잡아놓는다고 해서, <strong>무조건 처음부터 렌더링할 필요는 없다.</strong><br>\n오히려 사용자가 당장 보지 않을 요소라면, <strong>불필요한 초기 렌더링을 줄이는 것이 오히려 성능에 이롭다.</strong></p>\n<blockquote>\n<p><strong>비동기로 로딩되더라도, 어디에 어떤 크기로 들어올지는 예고해두고, 랜더링 타이밍은 미룬다.</strong><br>\n이게 바로 <strong>Lazy Load의 본질</strong>이다.</p>\n</blockquote>\n<p>개선 이후, 사용자가 화면을 처음 열었을 때 이제서야 ...<br>\n<strong>가장 먼저 보여줘야 할 콘텐츠</strong> 들이 이전보다 더 빠르고 안정적으로 나타나기 시작했다.</p>\n<p><strong>\"갑자기 튀어나오는 광고\"</strong> 나 <strong>\"스크롤을 내리면 밀리는 댓글 영역\"</strong> 등의 문제는 Fade Out !</p>\n<p>다음으로 가장먼저 보여지는 콘텐츠의 랜더링 속도를 보고나니, 자연스럽게 다음과 같은 고민으로 이어졌다.</p>\n<blockquote>\n<p><strong>‘첫 화면에서 아무것도 안 보이는 시간’</strong> 을 얼마나 줄일 수 있을까 ?</p>\n</blockquote>\n<hr>\n<h2>FCP - First Contentful Paint 😶‍🌫️</h2>\n<p>FCP 는 사용자가 페이지에서 <strong>\"첫 번째 콘텐츠(텍스트, 이미지 등)를 보는 순간까지의 시간\"</strong> 이다.</p>\n<p><strong>\"앞에서 무엇을 보여주느냐\"</strong> + <strong>\"얼마나 빨리 보여주느냐\"</strong> 가 광건이다.</p>\n<p>만약, 페이지에는 접근했으나 아무것도 안 보이는 상태가 길어진다면 FCP 점수는 나빠진다.<br>\n위쪽 영역(Above the Fold) 콘텐츠를 최대한 빨리 보여주는 것을 목표로 하였다.<br>\n( 이미지든 텍스트든, 뭐든간에 첫 화면이 빠르게 보이면 점수가 좋아진다. )</p>\n<table>\n<thead>\n<tr>\n<th>문제 요소</th>\n<th>설명</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>이미지 용량이 큰 경우</td>\n<td>상단 이미지를 lazy 처리하면 실제 첫 시각 요소가 늦게 등장함</td>\n</tr>\n<tr>\n<td>JS 의존형 컴포넌트</td>\n<td><code class=\"language-text\">hydrate</code> 이후에 렌더링되는 컴포넌트 의 경우, 초기 화면엔 보이지 않음</td>\n</tr>\n<tr>\n<td>웹폰트 지연 로딩 (FOUT/FOIT)</td>\n<td>커스텀 폰트가 늦게 적용되며 텍스트 위치가 늦게 나타남</td>\n</tr>\n<tr>\n<td>초기 데이터 비동기 처리</td>\n<td><code class=\"language-text\">useEffect</code>에서 데이터 fetch 이후, 첫 화면 렌더링이 지연됨</td>\n</tr>\n<tr>\n<td>너무 많은 요소 한꺼번에 렌더링</td>\n<td>초기 화면에서 꼭 보여야 할 핵심 콘텐츠조차 뒤늦게 등장하거나, 렌더링 경쟁에 밀려버리는 문제</td>\n</tr>\n</tbody>\n</table>\n<p>앞에서 CLS를 해결하며 \"무조건 다 보여주기\"가 아닌, **\"보여줄 타이밍과 우선순위\"**를 정리하게 되었고, 자연스럽게 FCP 개선으로 이어졌다.</p>\n<p>즉, 최초로 사용자에게 보여줄 콘텐츠를 최대한 빠르게, 그리고 안정적으로 렌더링하는 것이 핵심이다.</p>\n<p>개선하면서, 적용한 원칙 3가지는 다음과 같다.</p>\n<ul>\n<li><strong>이미지</strong> 라면 LCP 대상인지 확인하고, <strong>priority preload 설정</strong>으로 미리 불러오자.</li>\n<li><strong>폰트</strong> 라면 웹폰트 preload, 또는 <strong>시스템 기본체 fallback을 활용해 FOIT 현상</strong>을 줄이자.</li>\n<li><strong>컴포넌트</strong> 라면 SSR을 통해 최소한의 <em>구조라도 즉시</em> 보여주고, 이후 <strong>dynamic</strong> 하게 확장하자.</li>\n</ul>\n<p>위 원칙들을 적용하니, 페이지가 로드된 직후 \"사용자 눈에 보이는 콘텐츠가 없던 시간\" 을 눈에 띄게 줄일 수 있었다.</p>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 1rem;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 160px; '>\n      <a class='gatsby-resp-image-link' href='/static/e8de41b5ceaf1bd3283dc021d472b987/065de/img_7.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 66.875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAACJ0lEQVR42n2TTXPSUBSG8yNcCIF83XsJSSBAaGCAEqyFqGNRwRao1spGGSxjd46jGxeOP8CPnTPudPwv/qfXc1NqEYXFE27CuQ/vObkopmlCYlkWLtfryO9W2VQnUeTFMAxkMhlomnYhWGJKAbOQzWahqmpSI9kmVXRdh+d5eDgcIu71oNG9RhsMKVV1ZK6n0dm7gaPxCIdHR4jjOJFvkioyle/7mJ2dYTAawaA0FcbgUDJrr4SszxC39/F4MMbs2XNEUbQ1ZdKyRi1XiT7jmIgcnjCBZl5A/3Qf4scExud70CchMpaBlJoB39Zyli4NSvTFddHPkcjj2CkyhJSs5pgIGnkUThvg38coTlsopDSkLBNsk3DIBfpEyWWolzlaAUe0pF0lSgxRTodP8oOijV9FHx3OkDb+L1VGJKsWGNpSUOHYXYee71YFOiSvUOrXnoN3tgP18jSsHSelSsmSTUtBIg7+XUsikno0jgdCIKZ5qzR3k5DHSpIIW5WrZPKz5nPUiRa1X6fNO5Rerld/sOlynNCLEzR7TvJyuYwgCC6E7ZVCKXrRz+PtxMHdpsCbiYsPT110a/Syyld1YYnj0LTQqwQ4mU4xn8+xWCySP4jypx0qrHoMX18W8O28gJshx/F+Dj9fFdENV4RESOsDwXEn7yBstdCo12Hb9t9CiWz/dkPg48zD+SCPR90c3p+6KNOco2BVyNC3BW5ZDNfUNDSan5TJln8D/0GRA386fyUAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='만점 채운 FCP 점수' title='' src='/static/e8de41b5ceaf1bd3283dc021d472b987/065de/img_7.png' srcset='/static/e8de41b5ceaf1bd3283dc021d472b987/065de/img_7.png 160w' sizes='(max-width: 160px) 100vw, 160px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>만점 채운 FCP 점수</figcaption>\n  </figure></p>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 1rem;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 679px; '>\n      <a class='gatsby-resp-image-link' href='/static/a464985613126e878498c5079326e0b2/a96cc/img_6.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 24.11764705882353%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABZklEQVR42jWMXS+CcRiH+xipHEgvjn0UMwc+gGl5bTYvW4aVpRb1CJsD8jb1bNbmmDaObJiakoTayFukVHSSy1/m3u7tuq/9frdiZdWPNO/DK/kYG7MybLHgmV/E3NWN2+XCOj7FUH8/HmmBXlMPDpudKdsMA2az6Cwy2Gdh0jqOy+2ls70DBWKq1Sq1Wo377DO3l0m+hYueRqlWyjy/FkjF4r8xYtEYpfc8hdIXF5FI3SUTV7xks9QE7wTkv4efnxWKxQ9uzo/IPaR5eXokdXZAuVwhHT/hIZPgPZ8ncbxP6aNI5jLCXSpKIf/G9dkhb7knctk0e7vbKMLhMKFQCFmWmXXaWFrwsrW5gX1ypO6kWQfSnJNgIMD0xChBOciSz4PX7UDe2WXGZmV9zY9/ZZmhARMKpVKJRqNBrVajEtugUtW5QSVuwf9O09iI3mjEYDBgNLagbdbT1NpGs16wVotOpxNOxw9BlRhL39IAeAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='사용자가 첫 진입시 페이지 랜더링 체감' title='' src='/static/a464985613126e878498c5079326e0b2/a96cc/img_6.png' srcset='/static/a464985613126e878498c5079326e0b2/e7570/img_6.png 170w,\n/static/a464985613126e878498c5079326e0b2/f46e7/img_6.png 340w,\n/static/a464985613126e878498c5079326e0b2/a96cc/img_6.png 679w' sizes='(max-width: 679px) 100vw, 679px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>사용자가 첫 진입시 페이지 랜더링 체감</figcaption>\n  </figure></p>\n<blockquote>\n<p>오랜 시간 기다리던 페이지, 이젠 안녕이다.<br>\n첫 진입시, 콘텐츠가 직관적으로 뜰 때까지 기다리는 시간이 줄어들었다.</p>\n</blockquote>\n<h2>TBT</h2>\n<p>🚫 TBT는 JS가 렌더링을 막고 있는 시간을 말한다.</p>\n<p>TBT 에 직접 영향을 주는 요소로는 <strong>JS 번들 크기</strong>와 <strong>렌더링 시점</strong> 이지만 JS 번들 크기를 0.7MB 정도 다이어트 함과,\nTree Shaking 을 통해 불필요한 코드도 제거 했었다.</p>\n<p>코드 스플리팅, 불필요한 JS 제거, 그리고 불필요하게 SSR로 처리되던 인터랙티브한 위젯들 (ex. 댓글, 공유 모듈) 이 주요 원인 이였다.</p>\n<p>그런데, 앞서 FCP, CLS 를 해소하면서 자연스레 해소 되어버렸다.</p>\n<p>즉,</p>\n<p><strong>\"사용자에게 먼저 보여줄 콘텐츠만 빠르게 준비하고, 나머지는 뒤로 미루자\"</strong> 라는 개선 목표는,\n브라우저가 긴 JS 작업에 막히지 않고, 렌더링 병목을 해소하는 것으로 이어졌다.</p>\n<blockquote>\n<p>TBT 점수는 <strong>0ms</strong> 를 달성 하였다.</p>\n</blockquote>\n<h2>중간 배포 🙏</h2>\n<p>이제까지의 개선을 통해, Core Web Vitals 의 3대 요소를 모두 안정화 시켰다.<br>\nGoogle Core Web Vitals 의 경고가 약간의 조급함을 불러 일으켜서 인지.</p>\n<p>현재까지 개선한 부분에 대해서, 주간미팅 에서 팀원 분들께 공유를 드리기로 하였다.<br>\n그리고 중간배포를 진행하는것으로 마무리 되었다.</p>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 1rem;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 617px; '>\n      <a class='gatsby-resp-image-link' href='/static/8337bc364c4c6d85a78765f57d7f5a41/8a174/img_10.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 55.294117647058826%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAADGklEQVR42h2S3VPUZRTHf+PIy4bsG6k1mRr78nvZBZYFxB2DlgCJVVYymymCGsuaSVNzuqmp4QbRbLzZwYjQgQVz3RRckFxkW4JNNjNjGgXXAcexcsaLLvsHPp3p4szzMt/nnPOc70eJuWz0Op7muMtOv1tCzt+6zUxodmKGnWHDwrhmI25YuaxbyIhmzrWOtOcZVvRy7qg1LKuVLKl+Uvp6lGHVTK8IvxJhrzzuUS0MaBYGtSKG3EWMGGbinvWM6GbZFzPlLma8wsKCvomcy819rYplvYK/jQp+0p9Fibks9GtmBlTr/3FWtXHOmU+iLkCq4xAXqrayemyQZP0O5l5pIXcowg/NL5HTNvPAqGbJqGTVW8t9YxtxfQNKj3TXp9sZVEskmXxZ1sHNeWR2d5L79DvGdu4k9dZRfvvgBL90HeThqRTJ4A5uuzfwRPdJZ9X8VVbNHcNL0mFHOem1csJVyGmJM6UmIo5CIs4C4j4Hk8Eg0ZqtjPjMXGurY2K3n6utfkb9JURda0jI7xa0jaQ1K987TVyRUSkXPUVcD+9i5s2PSOzpYrSpgW/8zzPZ0sL55pdJvtHB8pGP+X3/O0wFtpBuC3E16OP63n1Mhdu5GKwm+XoHscZ6TusmlK/dCtn3DvPoyxusfnaBXPcl7h2fZvmLcTIHe/nz1DSL+99l5WgPmVfrWeh8m7tHIix+0k+28zB33+9m5fMY2Y5jRErXoEw7bKTFgLG9nSRa25hs3UP2w5PcONDNVKiNZFOQVP0L/LovxHyLg2xrGbfDr3EtHGasVmW2oZH59i7SoXbOydiUJa2ceUcJfeJsRKLfXcAZNV+wKWC4qoCJbYX8WLOOue1r+bnOxE2/iRk9j9GKfIbKCkW3lgEjj7PGU5wXnJR/vH5mBYG+MmFPDIp6LESFxcsy4Es+K6lGG5kmM7caN/K41sVD3cmiV2Ox0mDGs4U/muUurHMzsImxcnH5gVHLnFbKgMcsFS0MeYuJCsRxqTYbkIQNkixg57Fg8UgX7lQvq6qPe6oA7dzOk1CAfw/UcOvF50iU2fkPTUDRTjvFls4AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='하루 뒤 ㅋ' title='' src='/static/8337bc364c4c6d85a78765f57d7f5a41/8a174/img_10.png' srcset='/static/8337bc364c4c6d85a78765f57d7f5a41/e7570/img_10.png 170w,\n/static/8337bc364c4c6d85a78765f57d7f5a41/f46e7/img_10.png 340w,\n/static/8337bc364c4c6d85a78765f57d7f5a41/8a174/img_10.png 617w' sizes='(max-width: 617px) 100vw, 617px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>하루 뒤 ㅋ</figcaption>\n  </figure></p>\n<blockquote>\n<p>올 ...</p>\n</blockquote>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 1rem;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; '>\n      <a class='gatsby-resp-image-link' href='/static/1722891e715e4403c5fb8d3086beeebe/8a72f/img.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 120%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAYCAYAAAD6S912AAAACXBIWXMAAAsTAAALEwEAmpwYAAAEIklEQVR42nVU22scZRTf52Ztc2liLrtz27lfdmZ2ZyZ7ySZNW01SsWJ6pRohuAl5j4+CtkEhIoKgWIVUbSipVHwTbJoHFSyCvmqJL4H8C/X95/lmdyab3Rg4fJlvz/l9v3PO75xMNptFp/X1ZdF/Jouz/VmcOv0CTr3Y37o/ewZ9A6eRje8G0B2XWEaSJHSaKEp4ZUrB9RkZ4zULuashuLKO/CKdcz74qoXxt6cguhokXoRUOB6fEUURiQmCAFmWMT/tYjowofg2rJcnoZga5IYHwdchWSq0uQiCTI8LR7GJHQcUBSiKAq8UwCl6cG0Hk+UQhm5gtnEOURDGIEXdpFPoAYsBj6crgqcALpcHz/Mx4zzPxfeFQgEFYi9JrYe7S9WTMs/xxE6GYxvQ6z40WSFwIX2IgTNQVpJuS3yOUma10zWosy7OhxqqUybKuhozEsVWaixoZGQEg4NDGBpqG/0/MDCI8fHxFDQjUgpinoccOjAuerhRk7FYUzBp6NBUNWbGnCcmJnD7zgZ2dr7D3a+38NnWl9ja+gaPvv8BS0tvYXR0NM4gTZkjJnzDhFPXYU0bUC0ZAkfsCEyWCxgbG8Pe3h7Y3879L3B38118e+8r/PXPATY27sSMWfqZViMILM/B9BwEl8+h9vpLVAKV6tpqDnuZMdze3sb+/j6uXX4VNt3dunETP//yK9bX1zE8PNwCZM66rkPVNIQki3pURT2swCe56LYH3SrGKbPUTdOE57kkZhk8DYCqUkwYQKNYoS2jGLA02UBQnUaxWITtkJgtCgwqiGYvwaXfUiUQW47jILEmtTufp8yEDk1mWLoqOaokE1UW4dsqUVfBFUhGNBVym13S6WQ8uycsZagQkGEYrcbQ64xFy7E3iG//zvySe5WUwErGMm2lTGK2Sy68ogvXdeM6dbJJ9KXTSNpUkiL5eGRsRBNAVsMUMKbrkKjLNs2snjoen3ERFgXULQsm+WgdjDrTbQtbolpp1AyHmmHFrT+JYcFQUKIlYZGZbb/e1ccYsmCPnCoebNuOGQrdm4R922w0A5h+EY5lpwx7tw1tF1VToXhHTj1bpH0naAUIkpiO48kM6ceIijrjenGBTwTsAv4/S1NmWpNJJgJZIguOBMvOfD6PfC6HXNvYd47GMD3ZPZ2JlDIGbZXzFy6iNnMB5agWF5w1yCuVYhkFYYRyEKBULiOMJmn0fESVSvuswvdb3w7JjpHJNJvNeIP8+/w5Dg8PcXBwgGd/P8PmB+/hye5jPLh/Dw8fbOPxTz/i808/xtOnv+GjD9/Hn3/8jk82b2NvdxePHm7j2uJrtBcnkKnValhbW0OzuYLV1VWsrKxgeXkZVXr16pUrqFWrmG40cGlhAZUowtKbS/CLJt5ovoOwPodbN69jYX4eJk0bU8h/8GHuB4Kfl70AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='CLS 와 TBT, FCP 가 개선됨' title='' src='/static/1722891e715e4403c5fb8d3086beeebe/ca1dc/img.png' srcset='/static/1722891e715e4403c5fb8d3086beeebe/e7570/img.png 170w,\n/static/1722891e715e4403c5fb8d3086beeebe/f46e7/img.png 340w,\n/static/1722891e715e4403c5fb8d3086beeebe/ca1dc/img.png 680w,\n/static/1722891e715e4403c5fb8d3086beeebe/8a72f/img.png 780w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>CLS 와 TBT, FCP 가 개선됨</figcaption>\n  </figure></p>\n<p>직접 운영했던 서비스에서 이런 수치는 처음본 까닭에 기분은 좋았으나..</p>\n<p>빨간 지표로 보이는 LCP (Large Content's Paint) 와 SI (Speed Index) 가 마음을 어렵게 만들었다.</p>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 1rem;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 542px; '>\n      <a class='gatsby-resp-image-link' href='/static/7c4d4e4978d0db51b2aefbaba45121c9/47f85/img_9.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 82.3529411764706%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAAELklEQVR42k2S60/TVxzG+1qzN46ZzM2ZmflCI8tsQUUpUEAUh8BwwQGzgiKltKXceqHYC9BC77df76UFRCgMFafOTd1Njctmwl5sS5b9NZ8dyF7sxZNzkpPzOc/znK/M4xzAOz2Ib0YjpCXsNdB/tYUVh57fcvO8WYryaynHt0k7cVMvqtNy9u/fzztl+9izZy/KswqSEQvp2CSZuA2Zd1qzC/O7Bwm6tYTmdThG1Sy7TLxMevlGCnJfaNFlIGft40Z7IwcPfkBZWRl7975FU+NpcpKARa1kJQH0z/4H8gh381qiPgMB003SZi1bbjPRkT7hbIigQY00eg1tRwMHDrzLofcPUPb2PtTdFymkpsjGLeQSk8h2YOG5ISLzQ8S8OhIB4WRKy5rDyPO4k5JrhIxZw50ZA6mJ6/Q2Kzl2+D16GxRUHP8Ij6irkLQJl1ZySSuysIgYFb3FfXqkgJ6UTyeiengZd/PIa+Z1zs+faykeB23M9rXSXa+gu7Yc+xdNNNVX7oLyO0pYWdgBxgRA8utJBA0kQ8Nkg0aWrBrWLBqkwU5K5kGe+aeQ9F2MXa5B11rFjLqZS2c+4WbvJVZydtGdRbic3JUs4deRDA6TCRvJh4wUYqNIthv41O1E+zvZsI+zahVTMNCG+Uod5s5aes8pqJIfJhUeoyj6W/g/MC0g2fAICxEBE1qUJlgJ9DN37VOsbS24utpJj17Ffb2Fic+VDLdW0nbqCF11h3DrVeRjYyxmnRQztyimxS/nBWwXJA6W4hOshq6z7qwhMVTPVGsT4b4OQpqOXdhQswJ9i5weVTl9tR8S6S8XE1BDwdsjwOMspOzICpERirEJFuNjrPq+pGSvZ3myittjJ5ntrsXd24rlSgODFxRoL8ixdirpF3t98zGkvqPEBz9mw3WWlZlGMq4OZDvO1iI32fS2sTGlYt3eQGbkFKumKtxdcoztSvTnT2BoqcTWrcJ5VcAvnsTSWUF+SEFRPLw1reThXB0PffXINvyd3HWp2LBVUxqvpKCTkzfIWRyuIKI+iuniMSZvdOBUn2O2pwbr5VP0N59krusEJYPQqAAbxD19Bfec1cjuOhr5arKWgvGs+BwTmZSHaMRFIeehkHUT8U5hXryHP5kkEvHh8HmwRaLExXwu3/ERndeQuHacx/Y67phPI1u1qrhnUZIYP09o82fiyy8ILTzF6ntMLPuU7WKe11KMV4EAPxSWidz+CV/22e56S/qRua+3eCjSPXLUktCc2AHWi6hniBmbKDzf5tGLf0iv/0Lx/jYPnvzOm/sPeBKI8300yautJ6Q2tik9+4OV7/7Cu/k3E+ubuD47QrCnnPRABbJ1awMr49ViTKrxB50sLEkksyHyxTBLSzFyRYlprxuN9RamQBSHf55w0kd6OYI3F2J2RkdhQM7mhJKcRsG/KT0BVaKrxwUAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='LCP 4초 실화...' title='' src='/static/7c4d4e4978d0db51b2aefbaba45121c9/47f85/img_9.png' srcset='/static/7c4d4e4978d0db51b2aefbaba45121c9/e7570/img_9.png 170w,\n/static/7c4d4e4978d0db51b2aefbaba45121c9/f46e7/img_9.png 340w,\n/static/7c4d4e4978d0db51b2aefbaba45121c9/47f85/img_9.png 542w' sizes='(max-width: 542px) 100vw, 542px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>LCP 4초 실화...</figcaption>\n  </figure></p>\n<p>뭐 어찌됬든 점진적으로 개선하면 될것같다. <strike> 이제 그만 하고싶다 </strike></p>\n<p>아 참, 반가운 지표가 하나 더 발견되었는데, 중간 배포 이후 구글 Search Console 에서 확인한 지표 결과는 <strong>개선이 필요한 URL</strong> 은 <strong>빠른 URL 과</strong> 자리를 바꾸었다 🥰.</p>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 1rem;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; '>\n      <a class='gatsby-resp-image-link' href='/static/cfaca0f9933b21e069cddcd2b2fc966d/536b4/img_8.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 39.411764705882355%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABFklEQVR42n1R207DMBTr//8igicGE0xsze3ckpiTdEUboFWynDiK7dMssTA+T1/IhdA6oNZg1mG1o7ow9o8g2rDmiswNoQgWEUUIK4ob1mporTlXN7WJ3j3lwTeOxQt4PhIpFmJCThExJjcOnihIJc/1wAgYphNtoG3YtZvAach63+J3o3lpMBf04yv6u+PjiB7XTb8xvTbUOerfWUaTq17Vf24A4gl6eEZj/nf8n4bVBCYBpnnjAR4cN6Yzql+gkhAPTyjryS9fHNEfI01WD52GYhUsjCwZsVxQJgcUJSQfM9PqnFGMEeIZ9PaCms5g19TPdA+W4oaGJZGAxObzs7QrV+cRZHd7cSZvQc48dMe+Hh5rZnwDUKxzJQ3F7ngAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='이 사진 크몽의 bk 님이 올리셨던데... 저도 따라해 보니... 기분이 좋습니다 :) ' title='' src='/static/cfaca0f9933b21e069cddcd2b2fc966d/ca1dc/img_8.png' srcset='/static/cfaca0f9933b21e069cddcd2b2fc966d/e7570/img_8.png 170w,\n/static/cfaca0f9933b21e069cddcd2b2fc966d/f46e7/img_8.png 340w,\n/static/cfaca0f9933b21e069cddcd2b2fc966d/ca1dc/img_8.png 680w,\n/static/cfaca0f9933b21e069cddcd2b2fc966d/536b4/img_8.png 983w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>이 사진 크몽의 bk 님이 올리셨던데... 저도 따라해 보니... 기분이 좋습니다 :) </figcaption>\n  </figure></p>\n<h2>마무리</h2>\n<p>CLS, FCP, TBT 를 모두 안정화하면서 퍼포먼스 점수는 이전과는 다르게 상당히 점수가 올라갔다.<br>\nLighthouse, PageSpeed Insights, 서치콘솔까지 성능 개선 효과가 확실히 반영되기 시작했다.</p>\n<p>하지만 아직 개선되지 않은 <strong>LCP (Largest Contentful Paint)</strong> 와 <strong>SI (Speed Index)</strong></p>\n<table>\n<thead>\n<tr>\n<th>항목</th>\n<th>상태</th>\n<th>개선 포인트</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>LCP</td>\n<td>답도없음</td>\n<td>가장 큰 콘텐츠(대개 대표 이미지)를 더 빠르게 렌더링해야 함</td>\n</tr>\n<tr>\n<td>SI</td>\n<td>어떡함</td>\n<td>시각적으로 완성되는 속도를 높이기 위해 불필요한 CSS/JS를 줄이고, critical 리소스만 우선 처리 필요</td>\n</tr>\n</tbody>\n</table>\n<p>그러나 Core Web Vitals 의 5대 요소를 total <strong>90점 이상 유지</strong> 한다면.<br>\n다음과 같은 부분들을 누릴 수 있다.</p>\n<ul>\n<li>뉴스 검색 순위 떡상</li>\n<li>사용자 체류 시간 증가</li>\n<li>구글 검색에 이전 보다 더 많은 뉴스가 사용자 에게 노출</li>\n<li>광고 노출 은 덤으로 이어지는 선순환 구조 달성</li>\n</ul>\n<p>3부에서는 곧, 지옥이 펼쳐질 <strong>LCP를 어떻게 개선할 것인지</strong> 와, <strong>SI</strong> 개선에 대해서 다뤄볼 예정이다.</p>\n<p>참고</p>\n<ul>\n<li><a href=\"https://web.dev/articles/defining-core-web-vitals-thresholds?hl=ko\">Core Web Vitals 측정항목 기준점을 정의하는 방법</a></li>\n<li><a href=\"https://blog.kmong.com/%EA%B0%9C%EB%B0%9C%EC%9E%90%EB%A5%BC-%EC%9C%84%ED%95%9C-%EA%B2%80%EC%83%89%EC%97%94%EC%A7%84-%EC%B5%9C%EC%A0%81%ED%99%94-cls%EA%B0%80-%EB%AC%B4%EC%97%87%EC%9D%B8%EC%A7%80-%EC%9D%B4-%EA%B8%80-%EB%B3%B4%EA%B3%A0%EB%8F%84-%EB%AA%A8%EB%A5%B4%EB%A9%B4-%EB%8B%B9%EC%8B%A0%EC%9D%80-%EC%9B%90%EC%88%AD%EC%9D%B4-1ccd4da309d8\">크몽 - bk 님</a></li>\n</ul>","frontmatter":{"title":"퍼포먼스 최적화 를 향해 - 2부","date":"May 04, 2025","update":"May 04, 2024","tags":["front-end","performance","series"],"series":null},"fields":{"slug":"/phase4/"}},"seriesList":{"edges":[{"node":{"id":"157bc344-b416-5386-96b5-c8abcaaa04b1","fields":{"slug":"/deploy-strategy/"},"frontmatter":{"title":"배포전략"}}},{"node":{"id":"9ffe9bc1-affb-594e-835e-411f3a793a5a","fields":{"slug":"/cpu-bound-vs-io-bound/"},"frontmatter":{"title":"CPU Bound 와 IO Bound"}}},{"node":{"id":"57b20240-e6eb-5935-8501-3e6c67e74117","fields":{"slug":"/basic/"},"frontmatter":{"title":"코틀린의 현재와 미래"}}},{"node":{"id":"bb741bf1-7c1e-5b80-bb1a-14792a626e7f","fields":{"slug":"/coroutine/"},"frontmatter":{"title":"코 루틴"}}},{"node":{"id":"27dbdca2-3881-5505-8ab7-9ec45927fa02","fields":{"slug":"/basic/"},"frontmatter":{"title":"Redis"}}},{"node":{"id":"438d9589-dd16-5ed8-b45b-9f4a98acf02a","fields":{"slug":"/rag/"},"frontmatter":{"title":"Rag"}}},{"node":{"id":"949c21ae-8526-56ae-9f82-e1e9f517b13e","fields":{"slug":"/spring-ai/"},"frontmatter":{"title":"Ai. Spring AI 로 때워도 되나유? 1편"}}},{"node":{"id":"b9a90cce-fcd6-53ba-aa91-ef1e39152b15","fields":{"slug":"/phase1/"},"frontmatter":{"title":"🗞️ 한 달간의 뉴스 사이트 프론트 성능 최적화✨"}}},{"node":{"id":"1e90878c-3b63-5ee1-82dd-7c84ca638419","fields":{"slug":"/phase2/"},"frontmatter":{"title":"🏗️ AMP 페이지 개발"}}},{"node":{"id":"03510f8b-e65c-56a0-a96c-bc3935cc4600","fields":{"slug":"/phase3/"},"frontmatter":{"title":"퍼포먼스 최적화 를 향해 - 1부"}}},{"node":{"id":"720fdeea-fb60-5df7-a27a-47eba40a7300","fields":{"slug":"/phase4/"},"frontmatter":{"title":"퍼포먼스 최적화 를 향해 - 2부"}}},{"node":{"id":"50b5fb3c-da1f-5275-9401-02e0413fdf4e","fields":{"slug":"/resume/"},"frontmatter":{"title":"이력서"}}},{"node":{"id":"3c1cc0a1-e646-5b0c-a212-7785bb4bb6e6","fields":{"slug":"/architecture/"},"frontmatter":{"title":"설계의 본질"}}}]},"previous":{"fields":{"slug":"/phase3/"},"frontmatter":{"title":"퍼포먼스 최적화 를 향해 - 1부"}},"next":{"fields":{"slug":"/resume/"},"frontmatter":{"title":"이력서"}}},"pageContext":{"id":"720fdeea-fb60-5df7-a27a-47eba40a7300","series":null,"previousPostId":"03510f8b-e65c-56a0-a96c-bc3935cc4600","nextPostId":"50b5fb3c-da1f-5275-9401-02e0413fdf4e"}},"staticQueryHashes":[],"slicesMap":{}}